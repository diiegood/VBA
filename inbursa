Sub Automatizacion_proceso()

    Dim wsDestino As Worksheet  'hoja de trabajo
    Dim wsOrigen As Worksheet   'hoja donde se van a extraer los datos
    Dim celC As Range           'para el rango de valores que se van a modificar
    Dim encontrado As Range
    Dim rangoC As Range
    
    'hoja principal = hoja donde se aplican los cambios  / Carta_SOI
    'hoja secundaria = hoja de comprobacion y extracion de datos / Valores
    
    'primero se asignan las hojas
    Set wsDestino = ActiveSheet  'hoja donde se aplican los cambios hoja actual
    Set wsOrigen = ThisWorkbook.Sheets("Valores")  'hoja donde va hacer el checkeo SOI
    
    'Rango de celdas en donde se va realizar los cambios de los valores
    Set rangoC = wsDestino.Range("D31:D40") 'valores de la columna que se van a comprobar de la hoja principal
    
    'procesos a realizar
    ' 1 - validacion de que el rango de valores de D31:D40 coincide con alguno igual en la hoja SOI columna W.
    ' 2 - en caso de encontrar el valor va copiar la columna que corresponda de la columna X de SOI a la columna H de la CARTA SOI USD
    

    For Each celC In rangoC  'hoja donde va comprobar los valores para poder realizar el siguiente proceso
    
        Set encontrado = wsOrigen.Columns("A").Find(What:=celC.Value, LookIn:=xlValues, LookAt:=xlWhole)
                
        If Not encontrado Is Nothing Then
        
            With wsDestino.Cells(celC.Row, "H")
                .Value = wsOrigen.Cells(encontrado.Row, "C").Value
                .WrapText = True          'permite el texto en varios renglones
                .VerticalAlignment = xlTop   'alinea los datos arriba
                .HorizontalAlignment = xlLeft  'alinea los datos a la izquierda
            End With
        
        End If
        
    Next celC
    
    wsDestino.Rows("31:40").AutoFit  'Para poder ajustar las filas mostrando el texto
    MsgBox "Proceso completado."
         
 End Sub
 
